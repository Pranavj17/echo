####################### DATA STRUCTURE ################################

{
  "user_id": "123",
  "events": [
    {"timestamp": "...", "action": "onboard", "intent": 1, "details": "..."},
    {"timestamp": "...", "action": "payment", "intent": 0, "details": "..."},
    {"timestamp": "...", "action": "personalization", "intent": 2, "details": "..."}
  ],
  "memory_summary": "User onboarded with intent, made a payment (no intent), explored personalization (maybe intent)..."
}

########################


+-------------------+         +-------------------+         +-------------------+
|    Frontend/App   | <-----> |      Echo API     | <-----> |   PostgreSQL DB   |
+-------------------+         +-------------------+         +-------------------+
                                   |         ^
                                   v         |
                             +-------------------+
                             | Distributed Cache |
                             +-------------------+
                                   |
                                   v
                             +-------------------+
                             |      LLM Engine   |
                             +-------------------+

########################

[Frontend/App]
      |
      v
[Echo API (Rust)]
   |        |         \
   v        v          v
[PostgreSQL][Cache]<->[LLM Engine]


#############################

CREATE TABLE user_events (
    id SERIAL PRIMARY KEY,
    user_id UUID NOT NULL,
    timestamp TIMESTAMPTZ NOT NULL,
    action TEXT NOT NULL,
    intent INT NOT NULL, -- 0, 1, 2
    details JSONB
);

CREATE TABLE user_memory (
    user_id UUID PRIMARY KEY,
    memory_summary TEXT,
    last_updated TIMESTAMPTZ
);